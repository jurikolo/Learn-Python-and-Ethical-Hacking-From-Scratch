#!/usr/bin/env python

import scanner
import requests

target_url = "http://172.16.43.139/dvwa/"
links_to_ignore = ["http://172.16.43.139/dvwa/logout.php"]

data_dict = {"username": "admin", "password": "password", "Login": "submit"}
# response = requests.post(url=target_url, data=data_dict)
# print(response.content)

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
response = vuln_scanner.session.post("http://172.16.43.139/dvwa/login.php", data_dict)
vuln_scanner.crawl()
vuln_scanner.run_scanner()
forms = vuln_scanner.extract_forms("http://172.16.43.139/dvwa/vulnerabilities/xss_r/")
response1 = vuln_scanner.subnet_form(forms[0], "testtest", "http://172.16.43.139/dvwa/vulnerabilities/xss_r/")
print(response1.content.decode())

# test XSS in form
response2 = vuln_scanner.test_xss_in_form(forms[0], "http://172.16.43.139/dvwa/vulnerabilities/xss_r/")
print(response2)

# test XSS in link
response3 = vuln_scanner.test_xss_in_link("http://172.16.43.139/dvwa/vulnerabilities/xss_r/?name=jurikolo#")
print(response3)